

**Current Research** 
- Manafacturers instruction manuals - Default credentials
- Web Panel - Username & Password
- Network traffic - Open Ports - Port 23 / 22 Closed
- Physical hardware - Hardware com ports
- Embedded admin panel -CCTV Admin panel - Username & Password
- Mobile application 


**Existing Research**
- Exploits on Explot DB
- Any write ups of previous research
- CVE's 
- News Articles
- Github repos


** Web Panel Manual testing**
So first up the web panel.
I normally undertake a level of manual testing to get a feel for the applications.

As you can see here they were super helpful by telling me that I have the incorrect password or username.
They also like to insist on you using a very much older browser version to get it working correctly.

So I pulled out internet explorer to take a better look.
Just to note it's worth having different browsers as the behaviours can sometimes change dependending on what you use. 

When I opened it up in internet explorer it wanted me to download a exe, this exe would help install the active x plugins so it would work properly. 
That was a hard pass. 

I would say its worth reviewing the source code on the pages as I was able to find out further links and information from this. 

So normally whilst I am doing this I will have wireshark up and running

** Network Traffic**

Wireshark is a tool which can help you disect and review network traffic. 
There are literal books and courses on it, so I wont go to in depth here.
But if you look at the information panes you will see I was able to get some useful information to help me get started. 

I could see that it was using insecure protocol such as HTTP, therefore all the traffic was being sent plane over the network.
I could also seee that it was running UC-HTTPD server.

When inspecting the traffic I could also see that when sending over just a blank password it was pre filling it with some text. 

So I headed over to some CVE databases and done a search on it.  

I found a couple one being that you could log in as guest onto the system with a blank password. 

**Existing Vulnerabilities**
There were some more interesting CVE’s I found a buffer overflow but it was the directory traversal which was of interest to me.
So I span up burp...And it worked really well, I was able to get the root credentials. 

Burpsuite is a web application testing tools which is really handy for CTF’s bug bountys and web app pentesting. 

The next thing I done was take these credentials and put them in Hashcat.



**Existing Research**
So whilst this was running I decided to google the creds.
And it was a pretty good idea I did. 
I came across tothi’s work and his github write up, where he writes about exploiting hisilicon chip based dvr’s. 

As you can see his research was applicable across a wide range of makes and models and this is because a lot of manufactures will use the generic H264 firmware. 

So im all like awesome great, he says here with the user root and the password XC3511 I can log on to telnet port 23 and get access and that this is a hard coded back door.

The password matched the output from Hashcat..so I would give it a go.

So heres the value in saving time by seing what others have done...but in my case


**Telnet Access**

 -Denied
 
 ** Nmap**

Now Nmap is a great tool for seeing what running services and ports are on the product.

I’m running it here with jst a basic nmap scan and I havve also done a scan with UDP.
There are all sorts of fancy stuff and firewall evasion techniques you can do with it.
But you need to be care as it has been known to knock boxes offline and restart products. 
It also comes in a windows flavour called zenmap and you can see from the output there is no port 23 enabled. 


**Directory Traversal**
Using a directory travesal bug in the UC-http Server (uc-http1.0.0.0 CVE-2017-7577) I was able to get to the files on the CCTV box.

Root Password
Also I was able to get the hardcoded root password which was hashed in the expected /passwd /shadow files

**cracking Hashes**

Hash cat with crack hashed passwords and passwords lists that you give it.
This time round it took less that 5 minutes but it is worth looking into the flags you can use to help with use and cut down time.  


Digging around I found the Account1 and Account 2 password file
Account 2 is backup credential account. Account 1 is overwritten with new users.
I know this as I found my own credentials in there.
However it wasnt my password, it was showing some random hashed value I didnt know. 



**Rainbow Tables**
There was some concept code which showed how this hash function was working. 
And since hashing is a one way function we decided to route some password lists through it to make a rainbow table. 

But of course I wouldnt be that stupid to have my password on a password list like rockyou.

One of the things I did notice was that a blank password was the same blank password value which was submitted on the web panel.
But it was weird as it wouldn't accept the hashed passwords I had found online or in Account 1. 



**RTSP**
We saw we could put this hash value in as a password within the RTSP stream to view the cameras.
So thats cool I could see my cameras and also..

#!/bin/bash
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=1&stream=0.sdp' &
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=2&stream=0.sdp' &
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=3&stream=0.sdp' &
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=4&stream=0.sdp'






