# Introduction

**Observation:**  
It has been observed that there are multiple vulnerabliities in CCTV DVR’s purchased by consumers and that these vulnerablities are indeed exploited in the wild. These can either be directly accessed by viewers via websites such as Insecam ([Information Security Magazine](https://www.infosecurity-magazine.com/news/uk-security-cameras-risk-hacking/), 2020) or have been known to be actively exploited to be part of botnets ([threatpost](https://threatpost.com/hackers-exploited-0-day-cctv-camera/154051/), 2020).

Consumers may find it perticularly hard to purchase a “secure device” currently for home or business use, as there is little to no indication without undertaking their own research if that device is insecure or not. Services such as Which ([Which](https://www.which.co.uk/news/2019/10/the-cheap-security-cameras-inviting-hackers-into-your-home/), 2019) release reports advising consumers, but there are literally thousands of different types, models and brands on the open market and sold online at places such as Amazon which can make it difficult for consumers. In addition to this, many of these will use generic boards, firmwares and chips, of which they do not list the information publicly when sold.

**Question:**  
One piece of information which can be seen when purchasing is the “Date First Avaliable”, could this be a potential future metric consumers could use? which can bring us to ask:

“Has CCTV DVR Security improved over time?”

**Hypothesis:**  
It is anticipated that newer devices would be sold with additional security features or updates included, but this is an assumption.

A review has been undertaken on devices for sell on ebay and amazon aimed at consumers.

This is to see if any improvements have been made since the exploits have been made public. Where possible conduct comparisons between models and firmwares.

This is currently a small sample study, however a collection of sample firmwares has been collected for future research and comparison.

# Existing Research Review

A review of existing research was undertaken and from this a list of vulnerabilities was achieved. This is tabled in the next section. The links to research reviewed is within the [Notes](https://github.com/Chrissy-Morgan/DVR/tree/master/1.%20Notes) area. Notable resources to mention of which this research would not have been possible is the work undertaken by Istvan Toth Github POC’s ([Tothi, 2017)](https://github.com/tothi/pwn-hisilicon-dvr) who undertook research upon many CCTV DVR's firmwares to discover multiple vulnerabilities.


# Materials & Methods

The below lists the devices and the vulnerabilties which have been tested.  
This follows work that has been achieved previously with devices on the market.  
The known exploits have been mapped to the [OWASP IOT top ten](https://owasp.org/www-project-internet-of-things/) as part of this research.

| OWASP IOT Top Ten | Vulnerability | Tools | CVE | Method |
| --- | --- | --- | --- | --- |
| I7 Insecure Data Transfer and Storage | Insecure Transmission | Wireshark | Link | Network Testing |
| I1 Weak, Guessable, or Hardcoded Passwords | Insecure Guest Access URL | Browser | Link | Web App Manual Testing |
| I1 Weak, Guessable, or Hardcoded Passwords | Insecure Guest Access Login | Browser | Link | Web App Manual Testing |
| I3 Insecure Ecosystem Interfaces | Insecure blank password Access | Browser | Link | Web App Manual Testing |
| I5 Use of Insecure or Outdated Components | Directory Traversal | Burpsuite | Link | Web App Manual Testing |
| I1 Weak, Guessable, or Hardcoded Passwords | Root credentials | HashCat | Link | Web App Manual Testing |
| I9 Insecure Default Settings | Root Telnet | Telnet | Link | Network Testing |
| I1 Weak, Guessable, or Hardcoded Passwords | RTSP Camera access with credentials | RTSP | Link | Network Testing |
| I2 Insecure Network Services | Remote Back Door | Custom Script | Link | Network Testing |
| I10 Lack of Physical Hardening | Firware Extraction via SPI | CH341a & SPI Clip | Link | Hardware Pentesting |
| I10 Lack of Physical Hardening | U-Boot access via UART | FTDI & Minicom | Link | Hardware Pentesting |

# Methodology

## Web App Manual Testing

A survey of the web application panel was undertaken. This can normally be found at [http://192.168.1.10](http://192.168.1.10). Login prompts were manually tested for the insecure guest, default and admin access as well as the directory traversal CVE, which are all known issues.

Burpsuite and various browsers were used to test for issues, as the web panel behaved differently. For example Microsoft Edge was highlighted to be too modern to use and the user would need to use an older version. Also Internet explorer was advised to be the browser of choice due to the Active X plugin required for the web app to work appropriately.

Please see Web Application Testing Walkthrough for further details on how this was achieved.

## Network Testing

Network Testing was achived by running NMAP  to note all the TCP/UDP ports which were open on the device. From this we could ascertain any vulnerable services and possible connection routes.  From there on in manual probing was undertaken, using netcat and direct connections to the ports.

A custom script which had been made by … was used against the device to see if it would enable the Telnet access.  This script targets a possible backdoor/ “administration” port which then enables port 23 to be open. Not all devices will have port 23 open on them as default, so this script would need to be used in order to enable remote access.

RTSP is used within CCTV camera systems to enable the viewing of the device remotely, a direct connection to RTSP could be made with default / hardcoded credentials.

Please see Web Network Testing Walkthrough for further details on how this was achieved.

## Hardware penetration testing

By using the CH341A programmer it may be possible to make a direct SPI connection to the device to extract firmware. 

By using a FTDI USB to UART adapter it may be possible to interface with the U-Boot process and gain shell access. 

The correct connections were identified by obtaining schematics which document the similar generic board layouts, some of which use the same naming convention for the pin outs. By process of elimination it was possible to know which were the correct connections. 

Please see Web Hardware Testing Walkthrough for further details on how this was achieved.

* * *

# Results & Observations

* * *

**I1 Weak, Guessable, or Hardcoded Passwords**  
Use of easily bruteforced, publicly available, or unchangeable credentials, including backdoors in firmware or client software that grants unauthorized access to deployed systems.

**Vulnerabilities:**

- **Insecure Guest Access URL**  
    Access to the guest account could be achieved by a entering 192.168.1.10\\DVR.htm  
    This would give an overview of the system (without camera view) but leaked sufficient information which could be used to gain a foothold. Information such as the firmware version via the web app console. This made it possible to search for firmware online. 
    
- **Insecure Guest Access Login**  
    Access to the Guest account could be gained with default credentials. This could be achived by entering the username Default and blank password. This would once again give an overview of the system but without camera viewing.
    

**Results:**

| Device | Year | Firmware Version / Board | Insecure Guest Access URL | Insecure Guest Access Login |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |

**Observations:**

* * *

**I2 Insecure Network Services**  
Unneeded or insecure network services running on the device itself, especially those exposed to the internet, that compromise the confidentiality, integrity/authenticity, or availability of information or allow unauthorized remote control.

**Vulnerabilities:**

**\- Remote Back Door**

**Results:**

| Device | Year | Firmware Version | Remote Back Door |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |

**Observations:**
* * *

**I3 Insecure Ecosystem Interfaces**  
Insecure web, backend API, cloud, or mobile interfaces in the ecosystem outside of the device that allows compromise of the device or its related components. Common issues include a lack of authentication/authorization, lacking or weak encryption, and a lack of input and output filtering.

**Vulnerabilities:**

**\- Insecure blank password Access**

**Results:**

| Device | Year | Firmware Version | Insecure Blank Password |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

I4 Lack of Secure Update Mechanism - TBC  
Lack of ability to securely update the device. This includes lack of firmware validation on device, lack of secure delivery (un-encrypted in transit), lack of anti-rollback mechanisms, and lack of notifications of security changes due to updates.

**Vulnerabilities:**  
\*\*- \*\*

**Results:**

| Device | Year | Firmware Version |     |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

**I5 Use of Insecure or Outdated Components**  
Use of deprecated or insecure software components/libraries that could allow the device to be compromised. This includes insecure customization of operating system platforms, and the use of third-party software or hardware components from a compromised supply chain

**Vulnerabilities:**

**\- Directory Traversal**

**Results:**

| Device | Year | Firmware Version | Directory Traversal |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

I6 Insufficient Privacy Protection --TBC  
User’s personal information stored on the device or in the ecosystem that is used insecurely, improperly, or without permission.

**Vulnerabilities:**  
\*\*- \*\*

**Results:**

| Device | Year | Firmware Version |     |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

**I7 Insecure Data Transfer and Storage**  
Lack of encryption or access control of sensitive data anywhere within the ecosystem, including at rest, in transit, or during processing

**Vulnerabilities:**

**\- Insecure Transmission**

Whilst testing of the web panel was undertaken, Wireshark would be running in the background to log information sent over the network, to and from the device. It can be seen that the protocol being used is HTTP, therefore details can be sent over plaintext upon the network.

**Results:**

| Device | Year | Firmware Version | Insecure Transmission |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

I8 Lack of Device Management  --TBC

Lack of security support on devices deployed in production, including asset management, update management, secure decommissioning, systems monitoring, and response capabilities.

**Vulnerabilities:**  
\*\*- \*\*

**Results:**

| Device | Year | Firmware Version |     |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

**I9 Insecure Default Settings**  
Devices or systems shipped with insecure default settings or lack the ability to make the system more secure by restricting operators from modifying configurations.

**Vulnerabilities:**

**\- Root Telnet**

**Results:**

| Device | Year | Firmware Version | Root Telnet |     |
| --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |


**Observations:**

* * *

**I10 Lack of Physical Hardening**  
Lack of physical hardening measures, allowing potential attackers to gain sensitive information that can help in a future remote attack or take local control of the device.

**Vulnerabilities:**

**\- U-Boot Shell access via UART**

**\- Firmware Extration via SPI**

**\- Reverse Engineering of Embedded System.**

**Results:**


| Device | Year | Firmware Version | U-Boot Shell access via UART | Firmware Extration via SPI | Reverse Engineering of Embedded System |
| --- | --- | --- | --- | --- | --- |
|SecuLink |02/2017  |Uknown / Board - MBD6804T-EL  | Yes   | Yes   |
| Kare | —   |  |  | —   |
| Floureon | —   | —   | —   | —   |
| AVSonic |     |     |     |     |

**Observations:**

* * *

References  
Hackers Actively Exploit 0-Day in CCTV Camera Hardware  
Hackers Actively Exploit 0-Day in CCTV Camera Hardware (2020). Available at: [https://threatpost.com/hackers-exploited-0-day-cctv-camera/154051/](https://threatpost.com/hackers-exploited-0-day-cctv-camera/154051/) (Accessed: 29 June 2020).

Coker, J.
Coker, J. (2020) Over 100,000 UK Security Cameras Could Be at Risk of Hacking, Infosecurity Magazine. Available at: https://www.infosecurity-magazine.com/news/uk-security-cameras-risk-hacking/ (Accessed: 30 June 2020).
