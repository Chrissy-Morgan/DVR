# Introduction

**Observation:**  
It has been observed that there are multiple vulnerabliities in CCTV DVR’s purchased by consumers and that these vulnerablities are indeed exploited in the wild. These can either be directly accessed by viewers via websites such as Insecam ([7news](https://7news.com.au/technology/australians-being-seen-live-via-cctv-security-footage-on-russian-website-c-1122275), 2020) or have been known to be actively exploited to be part of botnets ([threatpost](https://threatpost.com/hackers-exploited-0-day-cctv-camera/154051/), 2020).

Consumers may find it perticularly hard to purchase a “secure device” currently for home or business use, as there is little to no indication without undertaking their own research if that device is insecure or not. Services such as Which ([Which](https://www.which.co.uk/news/2019/10/the-cheap-security-cameras-inviting-hackers-into-your-home/), 2019) release reports advising consumers, but there are literally thousands of different types, models and brands on the open market and sold online at places such as Amazon which can make it difficult for consumers. In addition to this, many of these will use generic boards, firmwares and chips, of which they do not list the information publicly when sold.

**Question:**  
One piece of information which can be seen when purchasing is the “Date First Avaliable”, could this be a potential future metric consumers could use? which can bring us to ask:

“Has CCTV DVR Security improved over time?”

**Hypothesis:**  
It is anticipated that newer devices would be sold with additional security features or updates included, but this is an assumption.

A review has been undertaken on devices for sell on ebay and amazon aimed at consumers.

This is to see if any improvements have been made since the exploits have been made public. Where possible conduct comparisons between models and firmwares.

This is currently a small sample study, however a collection of sample firmwares has been collected for future research and comparison. 

# Existing Research Review


A review of existing research was undertaken and from this a list of vulnerabilities was achieved. This is tabled in the next section. The links to research reviewed is within the [Notes](https://github.com/Chrissy-Morgan/DVR/tree/master/1.%20Notes) area. Notable resources to mention of which this research would not have been possible is work undertaken by Istvan Toth Github POC’s ([Tothi, 2017)](https://github.com/tothi/pwn-hisilicon-dvr)


![existing.png](:/c00d7a4ebf154d0b9cef79f9b9ed2168)


# Materials & Methods

The below lists the devices and the vulnerabilties which have been tested.  
This follows work that has been achieved previously with devices on the market.
The known exploits have been mapped to the [OWASP IOT top ten](https://owasp.org/www-project-internet-of-things/) as part of this research. 

 | OWASP IOT Top Ten | Vulnerability | Tools | CVE | Method |
 | --- | --- | --- | --- | --- |
  |I7 Insecure Data Transfer and Storage| Insecure Transmission | Wireshark | Link | Network Testing |
  |I1 Weak, Guessable, or Hardcoded Passwords| Insecure Guest Access URL | Browser | Link | Web App Manual Testing |
  |I1 Weak, Guessable, or Hardcoded Passwords| Insecure Guest Access Login | Browser | Link | Web App Manual Testing |
 |I3 Insecure Ecosystem Interfaces | Insecure blank password Access | Browser | Link | Web App Manual Testing |
 |I5 Use of Insecure or Outdated Components | Directory Traversal | Burpsuite | Link | Web App Manual Testing |
 | I1 Weak, Guessable, or Hardcoded Passwords| Root credentials | HashCat | Link | Web App Manual Testing |
 |I9 Insecure Default Settings | Root Telnet | Telnet | Link | Network Testing |
 |I1 Weak, Guessable, or Hardcoded Passwords| RTSP Camera access with credentials | RTSP | Link | Network Testing |
 |I2 Insecure Network Services | Remote Back Door | Custom Script | Link | Network Testing |
 | I2 Insecure Network Services| Buffer Overflow | Custom Script | Link | Network Testing |
  |I10 Lack of Physical Hardening| Firware Extraction via SPI | CH341a & SPI Clip | Link | Hardware Pentesting |
 | I10 Lack of Physical Hardening| U-Boot access via UART | FTDI & Minicom | Link | Hardware Pentesting |



# Methodology



## Web App Manual Testing
![web.png](:/dfd05eb2916e4d4b8cc78dea2e413621)


![directory-traversal.png](:/d6a7ecf781f14f4a87e1ab822518d806)

![root.png](:/cfcfd19685e348c9961d51e6bc50999a)

**Cracking Hashes**

Root default credentials could be found in the /etc directory. From this it was then possible to crack the hashed value with the use of HashCat.

![hashcat.png](:/a80b7d37a16e41328925d5853398ae95)




## Network Testing

![network.png](:/b19b4bfb3e0d42e2a46328594fe13f64)


RTSP
Hashed login credentials could be used to view and access cameras via RTSP on port 554. 
The script below shows how all four cameras could be accessed remotely. 

```
#!/bin/bash
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=1&stream=0.sdp' &
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=2&stream=0.sdp' &
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=3&stream=0.sdp' &
xterm -hold -e cvlc 'rtsp://192.168.1.10:554/user=admin&password=xc3511&channel=4&stream=0.sdp'
```

![RTSP.png](:/20806d4c525b49d08fbc150b658139c2)

![shodan.png](:/c26883160d2746cdbcb2efd4ad145a74)



Hardware penetration testing


* * *


# Results
* * *

**I1 Weak, Guessable, or Hardcoded Passwords**
Use of easily bruteforced, publicly available, or unchangeable credentials, including backdoors in firmware or client software that grants unauthorized access to deployed systems.

**Vulnerabilities:**
- **Insecure Guest Access URL**
Access to the guest account could be achieved by a entering 192.168.1.10\DVR.htm 
This would give an overview of the system (without camera view) but leaked sufficient information which could be used to gain a foothold. 


- **Insecure Guest Access Login**
Access to the Guest account could be gained with default credentials. This could be achived by entering the username Default and blank password. This would once again give an overview of the system but without camera viewing. 

 | Device | Year |Firmware Version | Insecure Guest Access URL | Insecure Guest Access Login 
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |

* * *
**I2 Insecure Network Services**	
Unneeded or insecure network services running on the device itself, especially those exposed to the internet, that compromise the confidentiality, integrity/authenticity, or availability of information or allow unauthorized remote control.

**Vulnerabilities:**
**- Remote Back Door**

**- Buffer Overflow**

 | Device | Year |Firmware Version | Remote Back Door | Buffer Overflow 
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |

* * *

**I3 Insecure Ecosystem Interfaces**	
Insecure web, backend API, cloud, or mobile interfaces in the ecosystem outside of the device that allows compromise of the device or its related components. Common issues include a lack of authentication/authorization, lacking or weak encryption, and a lack of input and output filtering.

**Vulnerabilities:**
**- Insecure blank password Access**

 | Device | Year |Firmware Version | Insecure Blank Password | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |

* * *

**I4 Lack of Secure Update Mechanism**	
Lack of ability to securely update the device. This includes lack of firmware validation on device, lack of secure delivery (un-encrypted in transit), lack of anti-rollback mechanisms, and lack of notifications of security changes due to updates.

**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |

* * *

**I5 Use of Insecure or Outdated Components**	
Use of deprecated or insecure software components/libraries that could allow the device to be compromised. This includes insecure customization of operating system platforms, and the use of third-party software or hardware components from a compromised supply chain

**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |
  
* * *
**I6 Insufficient Privacy Protection**	
User’s personal information stored on the device or in the ecosystem that is used insecurely, improperly, or without permission.

**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |
  
  
* * *

**I7 Insecure Data Transfer and Storage**	
Lack of encryption or access control of sensitive data anywhere within the ecosystem, including at rest, in transit, or during processing

**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |
  
  
* * *

**I8 Lack of Device Management**	
Lack of security support on devices deployed in production, including asset management, update management, secure decommissioning, systems monitoring, and response capabilities.

**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |

**I9 Insecure Default Settings**	
Devices or systems shipped with insecure default settings or lack the ability to make the system more secure by restricting operators from modifying configurations.


**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |


**I10 Lack of Physical Hardening**	
Lack of physical hardening measures, allowing potential attackers to gain sensitive information that can help in a future remote attack or take local control of the device.

**Vulnerabilities:**
**- **

 | Device | Year |Firmware Version |  | |
 | --- | --- | --- | --- | --- |
  | Kare | --- | Yes | Yes | --- |
  | --- | --- | --- | --- | --- |





* * *

**Network Access**

Insecure Transmission

Transmission of data was not encrypted.

I could also seee that it was running UC-HTTPD server.

When inspecting the traffic I could also see that when sending over just a blank password it was pre filling it with some text.

So I headed over to some CVE databases and done a search on it.

I found a couple one being that you could log in as guest onto the system with a blank password.


Now Nmap is a great tool for seeing what running services and ports are on the product.

I’m running it here with jst a basic nmap scan and I havve also done a scan with UDP.  
There are all sorts of fancy stuff and firewall evasion techniques you can do with it.  
But you need to be care as it has been known to knock boxes offline and restart products.  
It also comes in a windows flavour called zenmap and you can see from the output there is no port 23 enabled.


* * *

Hardware Pentesting

* * *




**Directory Traversal**

Using a directory travesal bug in the UC-http Server (uc-http1.0.0.0 CVE-2017-7577) I was able to get to the files on the CCTV box.

Root Password  
Also I was able to get the hardcoded root password which was hashed in the expected /passwd /shadow files

* * *


* * *

**Rainbow Tables**

There was some concept code which showed how this hash function was working.  
And since hashing is a one way function we decided to route some password lists through it to make a rainbow table.

But of course I wouldnt be that stupid to have my password on a password list like rockyou.

One of the things I did notice was that a blank password was the same blank password value which was submitted on the web panel.  
But it was weird as it wouldn’t accept the hashed passwords I had found online or in Account 1.

* * *


References  
Hackers Actively Exploit 0-Day in CCTV Camera Hardware  
Hackers Actively Exploit 0-Day in CCTV Camera Hardware (2020). Available at: [https://threatpost.com/hackers-exploited-0-day-cctv-camera/154051/](https://threatpost.com/hackers-exploited-0-day-cctv-camera/154051/) (Accessed: 29 June 2020).